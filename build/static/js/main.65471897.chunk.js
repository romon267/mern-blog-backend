(this["webpackJsonpblog-frontend"]=this["webpackJsonpblog-frontend"]||[]).push([[0],{149:function(e,t,n){},168:function(e,t,n){},176:function(e,t){},178:function(e,t){},189:function(e,t){},191:function(e,t){},218:function(e,t){},220:function(e,t){},221:function(e,t){},226:function(e,t){},228:function(e,t){},247:function(e,t){},259:function(e,t){},262:function(e,t){},265:function(e,t,n){"use strict";n.r(t);var r,s=n(1),c=n.n(s),a=n(49),o=n.n(a),i=n(4),u=n(10),l=(n(149),n(9)),d=n(2),j=n.n(d),b=n(6),m=n(16),f=n.n(m),h="/api/posts",x=null,p=function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get(h);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("".concat(h,"/all/best"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("".concat(h,"/user/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("".concat(h,"/url/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,f.a.post(h,t,n);case 3:return r=e.sent,console.log("what we get from server:",r.data),console.log("Author",r.data.author),e.abrupt("return",r.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:x}},e.next=3,f.a.put("".concat(h,"/").concat(t),n,r);case 3:return s=e.sent,e.abrupt("return",s.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N={getAll:p,getByUsername:g,getByUrl:v,getBestPosts:O,create:w,setToken:function(e){x="bearer ".concat(e)},deleteOne:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,f.a.delete("".concat(h,"/").concat(t),n);case 3:return r=e.sent,console.log("Sending req to delete post ".concat(t)),e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateOne:y},k=function(){return window.localStorage.removeItem("loggedInBlogappUser"),N.setToken(null),console.log("logged out"),{type:"REMOVE_USER"}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USER":case"LOGIN_USER":return t.data.user;case"REMOVE_USER":return null;default:return e}},T={getAll:function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},P=n(23),C=n(43),U=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return function(){var s=Object(b.a)(j.a.mark((function s(c){return j.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:r&&(console.log("id found"),clearTimeout(r)),c({type:"SET_NOTIFICATION",data:{type:e,message:t}}),console.log("dispatched"),r=setTimeout((function(){c({type:"REMOVE_NOTIFICATION"}),console.log("removed")}),1e3*n);case 4:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return{type:t.data.type,message:t.data.message};case"REMOVE_NOTIFICATION":return null;default:return e}},L=function(e){return{type:"SORT_POSTS",method:e}},_=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.updateOne(e.id,Object(P.a)(Object(P.a)({},e),{},{likes:e.likes+1}));case 2:r=t.sent,console.log(r),n({type:"UPDATE_POST",data:{savedPost:r}});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},D=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.deleteOne(e);case 2:n({type:"DELETE_POST",data:{id:e}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_POST":return[t.data].concat(Object(C.a)(e));case"DELETE_POST":return e.filter((function(e){return e.id!==t.data.id}));case"SORT_POSTS":var n=Object(C.a)(e);return"likes"===t.method?n.sort((function(e,t){return t.likes-e.likes})):"date"===t.method&&n.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})),n;case"UPDATE_POST":console.log("setting new state global");var r=t.data.savedPost,s=e.map((function(e){return e.id===r.id?r:e}));return s;case"INIT_POSTS":return t.data;default:return e}},F=(n(168),function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_OPENED":return!0;case"SET_CLOSED":return!1;default:return e}}),B=n(0),R="text-white px-2 hover:text-yellow-100 text-m",M="text-white hover:text-yellow-600 min-w-full hover:bg-gray-100 hover:opacity-50 block px-3 py-2 rounded-md text-base font-medium",V=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.mobileNavOpened}));console.log("OPEND:",t);return Object(B.jsx)("div",{className:"-mr-2 flex justify-end items-end md:hidden",children:Object(B.jsx)("button",{type:"button",className:"bg-orange-300 mb-2 inline-flex items-end justify-end p-2 rounded-md text-gray-400 hover:text-white hover:bg-orange-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white","aria-controls":"mobile-menu",onClick:function(){return e(t?{type:"SET_CLOSED"}:{type:"SET_OPENED"})},children:t?Object(B.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",stroke:"currentColor",className:"block h-6 w-6",viewBox:"0 0 16 16",children:[Object(B.jsx)("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"}),Object(B.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})]}):Object(B.jsx)("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:Object(B.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})})})},z=function(){var e=Object(i.c)((function(e){return e.activeUser})),t=Object(i.b)(),n=Object(i.c)((function(e){return e.mobileNavOpened}));return Object(B.jsxs)("div",{className:"px-5",children:[Object(B.jsx)(V,{}),Object(B.jsx)("div",{className:"flex flex-wrap text-center mx-auto justify-items-center space-y-1",children:n?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(u.c,{to:"/blog",activeClassName:"font-bold",className:M,children:"Blog"}),Object(B.jsx)(u.c,{to:"/users",activeClassName:"font-bold",className:M,children:"Users"}),e?Object(B.jsx)("div",{className:"flex justify-items-end items-end",children:Object(B.jsx)("button",{type:"button",onClick:function(){return t(k())},className:" text-right px-3 inline-flex self-end justify-end py-1 shadow-sm text-sm font-medium rounded-md text-white bg-gradient-to-r from-yellow-400 hover:from-orange-600 to-pink-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Logout"})}):Object(B.jsx)(u.c,{to:"/login",activeClassName:"font-bold",className:M,children:"Login"})]}):""})]})},W=function(){var e=Object(i.c)((function(e){return e.activeUser})),t=Object(i.b)();return Object(B.jsxs)("div",{className:"bg-gradient-to-r from-pink-500 to-yellow-500 py-4",children:[Object(B.jsx)("div",{className:"flex justify-end space-x-4",children:Object(B.jsxs)("div",{className:"hidden md:block px-10",children:[Object(B.jsx)(u.c,{to:"/blog",activeClassName:"font-bold",className:R,children:"Blog"}),Object(B.jsx)(u.c,{to:"/users",activeClassName:"font-bold",className:R,children:"Users"}),e?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("span",{className:"text-white mr-2",children:["Hello,"," ",e.username,"!"]}),Object(B.jsx)("button",{type:"button",onClick:function(){return t(k())},className:"px-3 py-1 mx-2 shadow-sm text-sm font-medium rounded-md text-white bg-gradient-to-r from-yellow-400 hover:from-orange-600 to-pink-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Logout"})]}):Object(B.jsx)(u.c,{to:"/login",activeClassName:"font-bold",className:"px-3 py-1 mx-2 shadow-sm text-sm font-medium rounded-md text-white bg-gradient-to-r from-yellow-400 hover:from-orange-600 to-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Login"})]})}),Object(B.jsx)("div",{className:"md:hidden ml-0",children:Object(B.jsx)(z,{})})]})},J=n(8),H=function(e){var t=e.post,n=Object(i.b)(),r=Object(i.c)((function(e){return e.activeUser})),s=Object(l.g)();return t?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("p",{className:"text-justify px-5 py-2",children:t.content?t.content:""}),Object(B.jsxs)("p",{className:"text-justify pl-5",children:["likes:"," ",Object(B.jsx)("strong",{children:t.likes})," ","author:"," ",Object(B.jsx)("strong",{children:t.author?t.author.username:"deleted"})," "]}),r?Object(B.jsxs)("div",{className:"flex px-3 justify-between",children:[Object(B.jsx)("button",{id:"likeButton",type:"button",onClick:function(){return n(_(t))},className:"py-1 px-3 mx-2 mt-2 shadow-sm text-sm font-medium rounded-md text-white bg-gradient-to-r from-pink-400 hover:from-pink-600 to-yellow-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Like"}),r.username===t.author.username?Object(B.jsx)("button",{type:"button",onClick:function(){return n(D(t.id)),s.push("/blog")},className:"py-1 px-3 mx-2 mt-2 shadow-sm text-sm font-medium rounded-md text-white bg-gradient-to-r from-orange-400 hover:from-orange-600 to-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Delete"}):""]}):""]}):null},G=function(e){var t=e.post,n=Object(i.b)(),r=Object(i.c)((function(e){return e.activeUser})),s=Object(l.g)();return t?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("p",{className:"text-justify px-5 py-2",children:t.content.length>160?t.content.slice(0,160).concat("..."):t.content}),Object(B.jsxs)("p",{className:"text-justify pl-5",children:["likes:"," ",Object(B.jsx)("strong",{children:t.likes})," ","author:"," ",Object(B.jsx)("strong",{children:t.author?t.author.username:"deleted"})," "]}),r?Object(B.jsxs)("div",{className:"flex px-3 justify-between",children:[Object(B.jsx)("button",{id:"likeButton",type:"button",onClick:function(){return n(_(t))},className:"py-1 px-3 mx-2 mt-2 shadow-sm text-sm font-medium rounded-md text-white bg-gradient-to-r from-pink-400 hover:from-pink-600 to-yellow-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Like"}),r.username===t.author.username?Object(B.jsx)("button",{type:"button",onClick:function(){return n(D(t.id)),s.push("/blog")},className:"py-1 px-3 mx-2 mt-2 shadow-sm text-sm font-medium rounded-md text-white bg-gradient-to-r from-orange-400 hover:from-orange-600 to-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Delete"}):""]}):""]}):null},q=function(e){var t=e.post,n=e.compact,r=Object(s.useState)(!1),c=Object(J.a)(r,2),a=c[0],o=c[1],i=Object(s.useState)("view"),l=Object(J.a)(i,2),d=l[0],j=l[1];if(!t)return null;return Object(B.jsx)("div",{className:"py-3 px-2 mx-2 my-2 border shadow rounded hover:bg-gray-100",children:n?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("h3",{children:[Object(B.jsx)(u.b,{to:"/blog/".concat(t.url),className:"font-bold text-xl px-5 text-gray-500 hover:text-gray-700",children:t.title}),t.content.length>160?Object(B.jsx)("button",{className:"ml-3 px-2 focus:outline-none shadow-sm rounded-sm bg-gray-100 hover:bg-gray-500 hover:text-white",type:"button",onClick:function(){o(!a),j("view"===d?"hide":"view")},children:d}):null]}),a?Object(B.jsx)(H,{post:t}):Object(B.jsx)(G,{post:t})]}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(u.b,{to:"/blog/".concat(t.url),className:"font-bold text-xl px-5 text-gray-500 hover:text-gray-700",children:t.title}),Object(B.jsx)(H,{post:t})]})})},K=function(e){var t=e.type,n=e.text,r=e.id;return Object(B.jsx)("button",{type:t,id:r,className:"inline-flex mt-4 py-2 px-4 shadow text-sm font-medium rounded-md text-white bg-gradient-to-r from-yellow-400 hover:from-pink-500 to-orange-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:n})},Q=function(){var e=Object(s.useState)(""),t=Object(J.a)(e,2),n=t[0],r=t[1],c=Object(s.useState)(""),a=Object(J.a)(c,2),o=a[0],u=a[1],l=Object(i.b)();return Object(B.jsxs)("form",{onSubmit:function(e){e.preventDefault();try{return l((t={title:n,content:o},function(){var e=Object(b.a)(j.a.mark((function e(n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.create(t);case 3:return r=e.sent,n(U("success",'Post "'.concat(r.title,'" successfully created!'),5)),e.abrupt("return",n({type:"ADD_POST",data:r}));case 8:return e.prev=8,e.t0=e.catch(0),console.log("error creating a post:",e.t0.response.data),e.abrupt("return",n(U("error","Error creating a new post!")));case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),r(""),u("")}catch(s){return l(U("error",s.response.data.error,5))}var t},children:[Object(B.jsx)("div",{children:Object(B.jsxs)("label",{htmlFor:"title",children:[Object(B.jsx)("span",{className:"block text-m font-medium",children:"Title"}),Object(B.jsx)("input",{id:"title",type:"text",value:n,name:"title",placeholder:"Title",className:"focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md shadow-sm sm:text-sm border-gray-300",onChange:function(e){var t=e.target;return r(t.value)}})]})}),Object(B.jsx)("div",{children:Object(B.jsxs)("label",{htmlFor:"content",children:[Object(B.jsx)("span",{className:"block text-m font-medium",children:"Content"}),Object(B.jsx)("textarea",{id:"content",type:"text",value:o,name:"content",cols:"30",rows:"10",placeholder:"Write here what you want to say...",className:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 mt-1 block w-full sm:text-sm border-gray-300 rounded-md",onChange:function(e){var t=e.target;return u(t.value)}})]})}),Object(B.jsx)(K,{id:"postSubmit",type:"submit",text:"Create"})]})},X=function(){var e=Object(s.useState)(!1),t=Object(J.a)(e,2),n=t[0],r=t[1],c=Object(i.b)(),a="mt-4 my-3 py-2 px-4 shadow text-sm font-medium rounded-md text-white bg-gradient-to-r from-yellow-400 hover:from-pink-500 to-orange-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",o=function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(L("date")),e.abrupt("return",r(!1));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(B.jsx)("div",{children:n?Object(B.jsx)("button",{type:"button",onClick:o,className:a,children:"sort by date"}):Object(B.jsx)("button",{type:"button",onClick:function(){return c(L("likes")),r(!0)},className:a,children:"sort by likes"})})},Y=function(){var e=Object(s.useState)(!0),t=Object(J.a)(e,2),n=t[0],r=t[1],c=Object(i.c)((function(e){return e.posts})),a=Object(i.c)((function(e){return e.activeUser})),o="mt-4 my-3 py-2 px-4 shadow text-sm font-medium rounded-md text-white bg-gradient-to-r from-yellow-400 hover:from-pink-500 to-orange-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500";if(!c)return Object(B.jsx)("div",{children:"Loading..."});var u=function(){r(!n)};return Object(B.jsxs)("div",{className:"text-gray-700 grid md:grid-cols-2 md:gap-5 md:px-8 mt-5",children:[Object(B.jsxs)("div",{className:"md:col-span-1 md:col-start-1",children:[Object(B.jsx)("h1",{className:"font-bold text-3xl antialiased",children:"Blog"}),a?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("h2",{children:"Create new post"}),Object(B.jsx)(Q,{posts:c})]}):"Login to create new posts!"]}),Object(B.jsxs)("div",{className:"md:col-span-1 md:col-start-2",children:[Object(B.jsxs)("div",{className:"flex justify-end space-x-4 mr-2",children:[n?Object(B.jsx)("button",{type:"button",onClick:u,className:o,children:"Full view"}):Object(B.jsx)("button",{type:"button",onClick:u,className:o,children:"Compact"}),Object(B.jsx)(X,{})]}),c.map((function(e){return Object(B.jsx)(q,{post:e,compact:n},e.id)}))]})]})},Z=function(){var e=Object(i.c)((function(e){return e.allUsers})),t=Object(s.useState)(null),n=Object(J.a)(t,2),r=n[0],c=n[1];return Object(s.useEffect)((function(){N.getBestPosts().then((function(e){console.log(e),c(e)}))}),[]),Object(B.jsxs)("div",{children:[Object(B.jsx)("h2",{className:"text-center font-bold text-2xl my-3",children:"Users in blog"}),Object(B.jsx)("div",{className:"md:grid md:grid-cols-5",children:Object(B.jsx)("div",{className:"shadow rounded border md:col-start-2 md:col-span-3",children:Object(B.jsxs)("table",{className:"divide-y min-w-full",children:[Object(B.jsx)("thead",{className:"bg-gray-50",children:Object(B.jsxs)("tr",{children:[Object(B.jsx)("th",{className:"p-3",children:"Users"}),Object(B.jsx)("th",{className:"p-3",children:"Posts"})]})}),Object(B.jsx)("tbody",{className:"divide-y bg-gray-100 rounded",children:e.map((function(e){return Object(B.jsxs)("tr",{className:"divide-y hover:bg-white",children:[Object(B.jsx)("td",{className:"text-center",children:Object(B.jsx)(u.b,{to:"/users/".concat(e.username),className:"hover:text-gray-500",children:e.username})}),Object(B.jsx)("td",{className:"text-center",children:e.posts.length})]},e.id)}))})]})})}),Object(B.jsx)("h2",{className:"text-center font-bold text-2xl my-3",children:"Data about posts and users"}),r?Object(B.jsx)("div",{className:"md:grid md:grid-cols-5",children:Object(B.jsx)("div",{className:"shadow rounded border md:col-start-2 md:col-span-3 mb-5",children:Object(B.jsxs)("table",{className:"divide-y min-w-full",children:[Object(B.jsx)("thead",{className:"bg-gray-50",children:Object(B.jsx)("tr",{children:Object(B.jsx)("th",{className:"p-3",colSpan:"2",children:"Best posts and users"})})}),Object(B.jsxs)("tbody",{className:"divide-y bg-gray-100 rounded",children:[Object(B.jsx)("tr",{children:Object(B.jsxs)("td",{className:"text-center font-semibold",colSpan:"2",children:["Most liked"," ",Object(B.jsx)("strong",{children:"post"})]})}),Object(B.jsxs)("tr",{className:"divide-y hover:bg-white",children:[Object(B.jsx)("td",{className:"text-center",children:Object(B.jsxs)(u.b,{to:"/blog/".concat(r.mostLikedPost.url),className:"hover:text-gray-500",children:[r.mostLikedPost.title,", likes:"," ",r.mostLikedPost.likes]})}),Object(B.jsxs)("td",{className:"text-center",children:["author:"," ",r.mostLikedPost.author.username]})]}),Object(B.jsx)("tr",{children:Object(B.jsxs)("td",{className:"text-center font-semibold",colSpan:"2",children:["Most liked"," ",Object(B.jsx)("strong",{children:"author"})]})}),Object(B.jsxs)("tr",{className:"divide-y hover:bg-white",children:[Object(B.jsx)("td",{className:"text-center",children:r.mostLikedAuthor.username}),Object(B.jsxs)("td",{className:"text-center",children:["Likes:"," ",r.mostLikedAuthor.likes]})]}),Object(B.jsx)("tr",{children:Object(B.jsx)("td",{className:"text-center font-semibold",colSpan:"2",children:"Author with most posts"})}),Object(B.jsxs)("tr",{className:"divide-y hover:bg-white",children:[Object(B.jsx)("td",{className:"text-center",children:r.mostPostsAuthor.username}),Object(B.jsxs)("td",{className:"text-center",children:["Posts:"," ",r.mostPostsAuthor.posts]})]}),Object(B.jsx)("tr",{children:Object(B.jsxs)("td",{className:"text-center font-semibold",colSpan:"2",children:["Total likes from posts -"," ",r.totalLikes]})})]})]})})}):Object(B.jsx)("div",{className:"text-center",children:"Loading..."})]})},$={login:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ee=function(){var e=Object(s.useState)(""),t=Object(J.a)(e,2),n=t[0],r=t[1],c=Object(s.useState)(""),a=Object(J.a)(c,2),o=a[0],u=a[1],d=Object(i.b)(),m=Object(l.g)(),f="focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md shadow-sm sm:text-sm border-gray-300 md:max-w-md",h=function(){var e=Object(b.a)(j.a.mark((function e(t){var r,s,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,$.login({username:n,password:o});case 4:return r=e.sent,N.setToken(r.token),window.localStorage.setItem("loggedInBlogappUser",JSON.stringify(r)),console.log("Logged in as:",r),d({type:"LOGIN_USER",data:{user:r}}),e.abrupt("return",m.push("/blog"));case 12:return e.prev=12,e.t0=e.catch(1),console.log(),(s=e.t0.response.data.errors)&&(s=s.map((function(e){return e.msg})).join(", ")),c=e.t0.response.data.error,a=s||c,e.abrupt("return",d(U("error",a)));case 20:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)("h2",{className:"font-bold text-2xl my-3",children:"Login now"}),Object(B.jsxs)("form",{onSubmit:h,children:[Object(B.jsx)("div",{children:Object(B.jsxs)("label",{htmlFor:"loginUsername",children:["Username",Object(B.jsx)("input",{type:"text",id:"loginUsername",value:n,name:"username",className:f,onChange:function(e){var t=e.target;return r(t.value)}})]})}),Object(B.jsx)("div",{children:Object(B.jsxs)("label",{htmlFor:"loginPassword",children:["Password",Object(B.jsx)("input",{id:"loginPassword",type:"password",value:o,name:"password",className:f,onChange:function(e){var t=e.target;return u(t.value)}})]})}),Object(B.jsx)(K,{type:"submit",text:"Login",id:"loginButton"})]})]})},te=function(){var e=Object(s.useState)(""),t=Object(J.a)(e,2),n=t[0],r=t[1],c=Object(s.useState)(""),a=Object(J.a)(c,2),o=a[0],u=a[1],l=Object(s.useState)(""),d=Object(J.a)(l,2),m=d[0],f=d[1],h=Object(s.useState)(""),x=Object(J.a)(h,2),p=x[0],O=x[1],g=Object(s.useState)(""),v=Object(J.a)(g,2),w=v[0],y=v[1],N=Object(i.b)(),k="focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md shadow-sm sm:text-sm border-gray-300 md:max-w-md",S=function(){var e=Object(b.a)(j.a.mark((function e(t){var r,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,$.register({name:n,username:o,email:m,password1:p,password2:w});case 4:return r=e.sent,console.log(r),e.abrupt("return",N(U("success","Registered successfully!",5)));case 9:return e.prev=9,e.t0=e.catch(1),console.log(e.t0.response.data),s=e.t0.response.data.errors.map((function(e){return e.msg})).join(", "),e.abrupt("return",N(U("error",s,15)));case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)("h2",{className:"font-bold text-2xl my-3",children:"Or register"}),Object(B.jsxs)("form",{onSubmit:S,children:[Object(B.jsx)("div",{children:Object(B.jsxs)("label",{htmlFor:"regName",children:["Name",Object(B.jsx)("input",{type:"text",value:n,name:"name",id:"regName",className:k,onChange:function(e){var t=e.target;return r(t.value)}})]})}),Object(B.jsx)("div",{children:Object(B.jsxs)("label",{htmlFor:"regUsername",children:["Username",Object(B.jsx)("input",{type:"text",value:o,name:"username",id:"regUsername",className:k,onChange:function(e){var t=e.target;return u(t.value)}})]})}),Object(B.jsx)("div",{children:Object(B.jsxs)("label",{htmlFor:"regEmail",children:["Email",Object(B.jsx)("input",{type:"text",value:m,name:"email",id:"regEmail",className:k,onChange:function(e){var t=e.target;return f(t.value)}})]})}),Object(B.jsx)("div",{children:Object(B.jsxs)("label",{htmlFor:"regPassword1",children:["Password",Object(B.jsx)("input",{type:"password",value:p,name:"password1",id:"regPassword1",className:k,onChange:function(e){var t=e.target;return O(t.value)}})]})}),Object(B.jsx)("div",{children:Object(B.jsxs)("label",{htmlFor:"regPassword2",children:["Confirm password",Object(B.jsx)("input",{type:"password",value:w,name:"password2",id:"regPassword2",className:k,onChange:function(e){var t=e.target;return y(t.value)}})]})}),Object(B.jsx)(K,{text:"Sign Up",type:"submit",id:"signUpButton"})]})]})},ne=function(){var e=Object(i.c)((function(e){return e.notification}));return e?Object(B.jsx)("div",{className:"success"===e.type?"bg-green-500 p-5 font-semibold rounded shadow m-3 text-white":"bg-red-400 p-5 font-semibold rounded shadow m-3 text-white",children:e.message}):null},re=function(e){var t=e.user;console.log("rendering component");var n=Object(i.c)((function(e){return e.posts.filter((function(e){return e.author.username===t.username}))}));return t?Object(B.jsxs)("div",{children:[Object(B.jsx)("h2",{className:"font-bold px-3 text-2xl my-2",children:t.username}),Object(B.jsxs)("h3",{children:[Object(B.jsx)("span",{className:"font-semibold px-3 text-xl",children:"List of all posts:"}),n.map((function(e){return Object(B.jsx)(q,{post:e,compact:!1},e.id)}))]})]}):null};re.defaultProps={user:{}||null};var se=re,ce=n(136),ae=n.n(ce),oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_POST_VIEW":return t.data;case"UPDATE_POST":return console.log("setting new state individual post"),t.data.savedPost;default:return e}},ie=function(e){var t=e.url,n=Object(s.useState)(""),r=Object(J.a)(n,2),c=r[0],a=r[1],o=Object(i.b)(),u=Object(i.c)((function(e){return e.postDetailView})),l=Object(i.c)((function(e){return e.activeUser}));return Object(s.useEffect)((function(){o(function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.getByUrl(e);case 2:r=t.sent,n({type:"SET_POST_VIEW",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}),[t]),u&&u.url===t?Object(B.jsx)("div",{className:"md:grid grid-cols-5",children:Object(B.jsxs)("div",{className:"col-start-2 col-span-3 border rounded shadow-sm text-center mt-5",children:[Object(B.jsx)("h2",{className:"text-3xl mt-3 md:text-4xl font-bold",children:u.title}),Object(B.jsx)(H,{post:u}),Object(B.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o(function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var s,c,a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=ae.a.randomBytes(12).toString("hex"),c=Object(P.a)(Object(P.a)({},t),{},{id:s}),n.next=4,N.updateOne(e.id,Object(P.a)(Object(P.a)({},e),{},{comments:[c].concat(Object(C.a)(e.comments))}));case 4:a=n.sent,console.log(a),r({type:"UPDATE_POST",data:{savedPost:a}});case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(u,{author:l.username,content:c})),a("")},children:[Object(B.jsxs)("label",{htmlFor:"comment",children:[Object(B.jsx)("span",{className:"font-semibold",children:"Add a comment:"}),Object(B.jsx)("div",{className:"grid grid-cols-5",children:Object(B.jsx)("textarea",{value:c,onChange:function(e){var t=e.target;return a(t.value)},type:"text",id:"comment",name:"comment",className:"focus:ring-indigo-500 col-span-3 col-start-2 focus:border-indigo-500 flex-1 block w-full rounded-md shadow-sm sm:text-sm border-gray-300"})})]}),Object(B.jsx)(K,{type:"submit",text:"Post",id:"commentSubmit"})]}),Object(B.jsxs)("h4",{className:"text-left ml-5 font-semibold",children:["Comments(",u.comments.length,"):"]}),Object(B.jsx)("ul",{className:"text-left ml-5 pb-3",children:u.comments.map((function(e){return Object(B.jsxs)("div",{children:[Object(B.jsx)("li",{children:e.content}),Object(B.jsx)("ul",{children:Object(B.jsxs)("li",{children:["by"," ",Object(B.jsx)("strong",{children:e.author}),l.username===e.author?Object(B.jsx)("button",{type:"button",onClick:function(){return o(function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var s,c;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.comments.filter((function(e){return e!==t})),n.next=3,N.updateOne(e.id,Object(P.a)(Object(P.a)({},e),{},{comments:s}));case 3:c=n.sent,r({type:"UPDATE_POST",data:{savedPost:c}});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(u,e))},className:"py-1 px-3 mx-2 mt-2 shadow-sm text-sm font-medium rounded-md text-white bg-gradient-to-r from-orange-400 hover:from-orange-600 to-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Delete"}):null]})})]},e.id)}))})]})}):Object(B.jsx)("h4",{children:"Loading..."})};var ue=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.allUsers})),n=Object(l.h)("/users/:username"),r=Object(l.h)("/blog/:postUrl"),c=n?t.find((function(e){return e.username===n.params.username})):null;return Object(s.useEffect)((function(){e(function(){var e,t=window.localStorage.getItem("loggedInBlogappUser");return t&&(e=JSON.parse(t),N.setToken(e.token),console.log("Found logged in user:",e)),{type:"INIT_USER",data:{user:e||null}}}())}),[]),Object(s.useEffect)((function(){e(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.getAll();case 2:n=e.sent,t({type:"INIT_POSTS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(s.useEffect)((function(){e(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.getAll();case 3:n=e.sent,t({type:"INIT_USERS",data:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("error fetching all users:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(B.jsxs)("div",{children:[Object(B.jsx)("header",{children:Object(B.jsx)(W,{})}),Object(B.jsxs)("main",{className:"px-4",children:[Object(B.jsx)(ne,{}),Object(B.jsxs)(l.d,{children:[Object(B.jsxs)(l.b,{path:"/blog/:url",children:[console.log("postMatch:",r),r?Object(B.jsx)(ie,{url:r.params.postUrl}):null]}),Object(B.jsx)(l.b,{path:"/blog",children:Object(B.jsx)(Y,{})}),Object(B.jsx)(l.b,{path:"/users/:username",children:Object(B.jsx)(se,{user:c})}),Object(B.jsx)(l.b,{path:"/users",children:Object(B.jsx)(Z,{})}),Object(B.jsx)(l.b,{path:"/login",children:Object(B.jsxs)("div",{className:"grid md:grid-cols-2 md:gap-5 md:px-12",children:[Object(B.jsx)(ee,{}),Object(B.jsx)(te,{})]})}),Object(B.jsx)(l.b,{path:"/",children:Object(B.jsx)(l.a,{to:"/blog"})})]})]})]})},le=n(28),de=n(137),je=n(138),be=Object(le.combineReducers)({notification:I,posts:A,activeUser:S,allUsers:E,postDetailView:oe,mobileNavOpened:F}),me=Object(le.createStore)(be,Object(je.composeWithDevTools)(Object(le.applyMiddleware)(de.a)));o.a.render(Object(B.jsx)(c.a.StrictMode,{children:Object(B.jsx)(i.a,{store:me,children:Object(B.jsx)(u.a,{children:Object(B.jsx)(ue,{})})})}),document.getElementById("root"))}},[[265,1,2]]]);
//# sourceMappingURL=main.65471897.chunk.js.map